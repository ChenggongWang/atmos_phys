
                      module   ch4_n2o_mod


use  utilities_mod,     only:  open_file, file_exist,    &
			       check_nml_error, error_mesg, &
			       print_version_number, FATAL, NOTE, &
			       close_file, get_my_pe, read_data, &
			       write_data
!use  constants_mod, only:  wtmair
use lw_gases_stdtf_mod, only:  ch4_lblinterp, n2o_lblinterp

!--------------------------------------------------------------------

implicit none
private

!---------------------------------------------------------------------
!                    module which obtains ch4_n2o longwave 
!                  radiation transmission function components
!
!---------------------------------------------------------------------



!---------------------------------------------------------------------
!----------- ****** VERSION NUMBER ******* ---------------------------

         character(len=128)  :: version =  '$Id: ch4_n2o.F90,v 1.4 2003/04/09 20:58:50 fms Exp $'
         character(len=128)  :: tag     =  '$Name: inchon $'

!---------------------------------------------------------------------
!-------  interfaces --------

public    ch4_n2o_init, ch4_n2o_time_vary


public   ch4_n2o_input_type

type ch4_n2o_input_type
	real, dimension(20)    :: bdl20hcn, bdh20hcn
	real, dimension(10)    :: af10h2o, bdl10h2o, bdh10h2o, &
				  bdl10hcn, bdh10hcn, bf10h2o
	real, dimension(4)     :: af4h2o, bdl4h2o, bdh4h2o, &
				  bdl4hcn, bdh4hcn, bf4h2o
	real, dimension(2)     :: af2h2o, bdl2h2o, bdh2h2o, &
				  bdl2hcn, bdh2hcn, bf2h2o
	real                   :: af1h2o, bdl1h2o, bdh1h2o, &
				  bdl1hcn, bdh1hcn, bf1h2o
	real, dimension(3,20)  :: af20ch4, af20n2o, bf20ch4, bf20n2o
	real, dimension(3,10)  :: af10ch4, af10n2o, bf10ch4, bf10n2o
	real, dimension(3, 4)  :: af4ch4, af4n2o, bf4ch4, bf4n2o
	real, dimension(3, 2)  :: af2ch4, af2n2o, a172n2o, bf2ch4, &
				  bf2n2o, b172n2o 
	real, dimension(3   )  :: af1ch4, af1n2o, a171n2o, bf1ch4, &
				  bf1n2o, b171n2o
        real, dimension(2,10)  :: cpf10h2o, csf10h2o
        real, dimension(2, 4)  :: cpf4h2o, csf4h2o
        real, dimension(2, 2)  :: cpf2h2o, csf2h2o
        real, dimension(2   )  :: cpf1h2o, csf1h2o
end type ch4_n2o_input_type

!---------------------------------------------------------------------
!-------- namelist  ---------

 integer  :: dummy


 namelist /ch4_n2o_nml/                      &
			 dummy



!---------------------------------------------------------------------
!------- public data ------


type(ch4_n2o_input_type), public   :: CN_basic

integer                    ::  k, mm, m

!---------------------------------------------------------------------
!   data for h2o for 10 20 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data (CN_basic%af10h2o(k),k=1,10)    /   &
     &   0.587965E+00,  0.501611E+00,  0.740500E+00,  0.555079E+01, &
     &   0.221491E+01,  0.141263E+02,  0.215772E+02,  0.208761E+02, &
     &   0.112267E+03,  0.238073E+03/

      data (CN_basic%bf10h2o(k),k=1,10)    /  &
     &   0.136093E+00,  0.215200E+00,  0.215289E+00,  0.196231E+00, &
     &   0.433159E+00,  0.279419E+00,  0.263223E+00,  0.202895E+00, &
     &   0.211683E+00,  0.151673E+00/

      data CN_basic%cpf10h2o            / &
     &   0.189824E-01, -0.660707E-04, &
     &   0.175350E-01, -0.275910E-04, &
     &   0.142808E-01, -0.274332E-04, &
     &   0.142165E-01, -0.415313E-04, &
     &   0.260793E-01, -0.524774E-04, &
     &   0.182821E-01, -0.573604E-04, &
     &   0.199166E-01, -0.721160E-04, &
     &   0.147737E-01, -0.477693E-04, &
     &   0.124860E-01, -0.483700E-04, &
     &   0.951027E-02, -0.441301E-04/

      data CN_basic%csf10h2o            / &
     &   0.179076E-01, -0.493954E-04, &
     &   0.188315E-01, -0.282847E-04, &
     &   0.165058E-01, -0.155592E-04, &
     &   0.163390E-01, -0.389195E-04, &
     &   0.198982E-01, -0.380731E-04, &
     &   0.156372E-01, -0.462165E-04, &
     &   0.143535E-01, -0.410551E-04, &
     &   0.116195E-01, -0.260344E-04, &
     &   0.100036E-01, -0.367164E-04, &
     &   0.846707E-02, -0.385911E-04/

      data CN_basic%bdl10h2o / &
     &   0.120000E+04,  0.122000E+04,  0.124000E+04,  0.126000E+04, &
     &   0.128000E+04,  0.130000E+04,  0.132000E+04,  0.134000E+04, &
     &   0.136000E+04,  0.138000E+04                              /

      data CN_basic%bdh10h2o /   &
     &   0.122000E+04,  0.124000E+04,  0.126000E+04,  0.128000E+04,&
     &   0.130000E+04,  0.132000E+04,  0.134000E+04,  0.136000E+04, &
     &   0.138000E+04,  0.140000E+04                              /

!---------------------------------------------------------------------
!   data for h2o for 4 50 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af4h2o  /  &
     &   0.676625E+00,  0.316169E+01,  0.208415E+02,  0.141927E+03/

      data CN_basic%bf4h2o  / &
     &   0.155982E+00,  0.249785E+00,  0.247080E+00,  0.152715E+00/

      data CN_basic%cpf4h2o /    &
     &   0.166392E-01, -0.428283E-04,  &
     &   0.175692E-01, -0.295058E-04,  &
     &   0.175389E-01, -0.566292E-04, &
     &   0.105481E-01, -0.443731E-04/

      data CN_basic%csf4h2o /  &
     &   0.184822E-01, -0.337057E-04,  &
     &   0.177179E-01, -0.351393E-04,  &
     &   0.140172E-01, -0.386980E-04,  &
     &   0.938797E-02, -0.366436E-04/

      data CN_basic%bdl4h2o /  &
     &   0.120000E+04,  0.125000E+04,  0.130000E+04,  0.135000E+04/

      data CN_basic%bdh4h2o /  &
     &   0.125000E+04,  0.130000E+04,  0.135000E+04,  0.140000E+04/

!---------------------------------------------------------------------
!   data for h2o for 2 100 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af2h2o  /  &
     &   0.191916E+01,  0.813840E+02/

      data CN_basic%bf2h2o  /  &
     &   0.191841E+00,  0.147305E+00/

      data CN_basic%cpf2h2o /  &
     &   0.174097E-01, -0.317609E-04,  &
     &   0.114313E-01, -0.432460E-04/

      data CN_basic%csf2h2o /   &
     &   0.179228E-01, -0.347266E-04,  &
     &   0.109031E-01, -0.361374E-04/

      data CN_basic%bdl2h2o /    &
     &   0.120000E+04,  0.130000E+04/

      data CN_basic%bdh2h2o /   &
     &   0.130000E+04,  0.140000E+04/

!---------------------------------------------------------------------
!   data for h2o for 1 200 cm-1 wide band in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af1h2o  /   &
     &   0.416516E+02/

      data CN_basic%bf1h2o  /  &
     &   0.993856E-01/

      data CN_basic%cpf1h2o /   &
     &   0.115749E-01, -0.425616E-04/

      data CN_basic%csf1h2o /    &
     &   0.119546E-01, -0.343610E-04/

      data CN_basic%bdl1h2o /    &
     &              0.120000E+04/

      data CN_basic%bdh1h2o /    &
     &              0.140000E+04/

!---------------------------------------------------------------------
!   data for n2o for 1 240 cm-1 wide band in 560-800 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%a171n2o            /   &
     &   0.672497E+02,  0.666852E+02,  0.659342E+02/

      data CN_basic%b171n2o            /    &
     &   0.455501E+00,  0.548340E+00,  0.636213E+00/

!---------------------------------------------------------------------
!   data for n2o for 2 bands (560-670, 670-800) in 560-800 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%a172n2o            /    &
     &   0.146625E+03,  0.145274E+03,  0.143502E+03,   &
     &   0.858478E-01,  0.187114E+00,  0.299843E+00/

      data CN_basic%b172n2o            /    &
     &   0.962917E+00,  0.115022E+01,  0.132963E+01,   &
     &   0.311756E+00,  0.272517E+00,  0.241252E+00/

!---------------------------------------------------------------------
!   data for ch4 for 1 200 cm-1 wide band in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af1ch4    /    &
     &   0.991960E+03,  0.986250E+03,  0.980040E+03/

      data CN_basic%bf1ch4            /    &
     &   0.404914E+00,  0.472640E+00,  0.558593E+00/

      data CN_basic%bdl1hcn /   &
     &              0.120000E+04/

      data CN_basic%bdh1hcn /    &
     &              0.140000E+04/

!---------------------------------------------------------------------
!   data for ch4 for 2 100 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af2ch4            /    &
     &   0.594537E+03,  0.635652E+03,  0.669067E+03,   &
     &   0.138938E+04,  0.133685E+04,  0.129101E+04/

      data CN_basic%bf2ch4            /     &
     &   0.417999E+00,  0.506508E+00,  0.619234E+00,    &
     &   0.425648E+00,  0.476435E+00,  0.541511E+00/

      data CN_basic%bdl2hcn /     &
     &   0.120000E+04,  0.130000E+04/

      data CN_basic%bdh2hcn /     &
     &   0.130000E+04,  0.140000E+04/

!---------------------------------------------------------------------
!   data for n2o for 1 200 cm-1 wide band in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af1n2o            /    &
     &   0.643127E+03,  0.643482E+03,  0.644438E+03/

      data CN_basic%bf1n2o            /     &
     &   0.379598E+00,  0.467694E+00,  0.572510E+00/

!---------------------------------------------------------------------
!   data for n2o for 2 100 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af2n2o            /    &
     &   0.103273E+04,  0.972518E+03,  0.923958E+03,   &
     &   0.253527E+03,  0.314445E+03,  0.364919E+03/

      data CN_basic%bf2n2o            /    &
     &   0.551991E+00,  0.648801E+00,  0.768242E+00,  &
     &   0.214445E+00,  0.291676E+00,  0.379852E+00/

!---------------------------------------------------------------------
!   data for ch4 for 20 10 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data ((CN_basic%af20ch4(mm,m), mm=1,3), m=1,10) /    &
     &   0.541738E+01,  0.149415E+02,  0.316424E+02, &
     &   0.221840E+02,  0.600096E+02,  0.115042E+03, &
     &   0.513049E+02,  0.115012E+03,  0.192519E+03, &
     &   0.116671E+03,  0.217752E+03,  0.318171E+03, &
     &   0.369587E+03,  0.558542E+03,  0.703065E+03, &
     &   0.530616E+03,  0.668545E+03,  0.743652E+03, &
     &   0.112896E+04,  0.117269E+04,  0.114441E+04, &
     &   0.112937E+04,  0.105901E+04,  0.976948E+03, &
     &   0.163922E+04,  0.137844E+04,  0.120808E+04, &
     &   0.952039E+03,  0.111158E+04,  0.125715E+04/

      data ((CN_basic%af20ch4(mm,m), mm=1,3), m=11,20) /   &
     &   0.583244E+04,  0.553139E+04,  0.524180E+04, &
     &   0.602979E+03,  0.436940E+03,  0.339188E+03, &
     &   0.184318E+04,  0.142597E+04,  0.114662E+04, &
     &   0.228036E+04,  0.196015E+04,  0.168831E+04, &
     &   0.205452E+04,  0.210354E+04,  0.203269E+04, &
     &   0.910614E+03,  0.119686E+04,  0.136864E+04, &
     &   0.303685E+03,  0.541698E+03,  0.761027E+03, &
     &   0.514195E+02,  0.129383E+03,  0.232595E+03, &
     &   0.107979E+02,  0.341526E+02,  0.791354E+02, &
     &   0.383356E+01,  0.839585E+01,  0.201371E+02/

      data ((CN_basic%bf20ch4(mm,m), mm=1,3), m=1,10) /   &
     &   0.140597E+01,  0.107253E+01,  0.909469E+00,  &
     &   0.930345E+00,  0.800640E+00,  0.765291E+00, &
     &   0.834003E+00,  0.788877E+00,  0.811419E+00, &
     &   0.676836E+00,  0.658991E+00,  0.691264E+00, &
     &   0.599292E+00,  0.583087E+00,  0.606930E+00, &
     &   0.497541E+00,  0.493702E+00,  0.529075E+00, &
     &   0.446318E+00,  0.429518E+00,  0.446875E+00, & 
     &   0.347650E+00,  0.385891E+00,  0.470133E+00, &
     &   0.420421E+00,  0.499090E+00,  0.629573E+00, &
     &   0.130655E+01,  0.157882E+01,  0.193749E+01/ 

      data ((CN_basic%bf20ch4(mm,m), mm=1,3), m=11,20) /   &
     &   0.145343E+01,  0.145919E+01,  0.148480E+01,  &
     &   0.132845E+00,  0.162588E+00,  0.221377E+00, &
     &   0.264668E+00,  0.280645E+00,  0.329993E+00,  &
     &   0.426686E+00,  0.439313E+00,  0.493890E+00,  &
     &   0.588191E+00,  0.594046E+00,  0.645834E+00, &
     &   0.706437E+00,  0.703880E+00,  0.742999E+00, &
     &   0.771077E+00,  0.701972E+00,  0.664706E+00,&
     &   0.904206E+00,  0.785960E+00,  0.730641E+00, &
     &   0.155259E+01,  0.128836E+01,  0.110938E+01, &
     &   0.168593E+01,  0.206291E+01,  0.189115E+01/ 

      data CN_basic%bdl20hcn / &
     &   0.120000E+04,  0.121000E+04,  0.122000E+04,  0.123000E+04, &
     &   0.124000E+04,  0.125000E+04,  0.126000E+04,  0.127000E+04, &
     &   0.128000E+04,  0.129000E+04,  0.130000E+04,  0.131000E+04, &
     &   0.132000E+04,  0.133000E+04,  0.134000E+04,  0.135000E+04, &
     &   0.136000E+04,  0.137000E+04,  0.138000E+04,  0.139000E+04/

      data CN_basic%bdh20hcn /   &
     &   0.121000E+04,  0.122000E+04,  0.123000E+04,  0.124000E+04, &
     &   0.125000E+04,  0.126000E+04,  0.127000E+04,  0.128000E+04, &
     &   0.129000E+04,  0.130000E+04,  0.131000E+04,  0.132000E+04, &
     &   0.133000E+04,  0.134000E+04,  0.135000E+04,  0.136000E+04, &
     &   0.137000E+04,  0.138000E+04,  0.139000E+04,  0.140000E+04/

!---------------------------------------------------------------------
!   data for n2o for 20 10 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data ((CN_basic%af20n2o(mm,m), mm=1,3), m=1,10) /  &
     &   0.473813E+01,  0.952553E+01,  0.147791E+02,  &
     &   0.909521E+00,  0.224093E+01,  0.444999E+01, &
     &   0.315236E+01,  0.490617E+01,  0.902568E+01, &
     &   0.110699E+02,  0.234900E+02,  0.472483E+02, &
     &   0.645586E+02,  0.140166E+03,  0.231457E+03, &
     &   0.438733E+03,  0.647933E+03,  0.814761E+03, &
     &   0.182650E+04,  0.197295E+04,  0.201000E+04, &
     &   0.315703E+04,  0.278044E+04,  0.248269E+04, &
     &   0.136891E+04,  0.115596E+04,  0.103125E+04, &
     &   0.345168E+04,  0.298757E+04,  0.259392E+04/

      data ((CN_basic%af20n2o(mm,m), mm=1,3), m=11,20) /  &
     &   0.220850E+04,  0.250545E+04,  0.264059E+04, &
     &   0.312174E+03,  0.581765E+03,  0.865425E+03, &
     &   0.144278E+02,  0.555433E+02,  0.135066E+03, &
     &   0.154592E+00,  0.164545E+01,  0.783978E+01,& 
     &   0.473001E-03,  0.162100E-01,  0.167608E+00,  &
     &   0.124882E-03,  0.131475E-02,  0.598214E-02, &
     &   0.612795E-03,  0.447533E-02,  0.159139E-01, &
     &   0.200166E-02,  0.109601E-01,  0.321069E-01, &
     &   0.279249E-02,  0.126745E-01,  0.326950E-01, &
     &   0.134100E-02,  0.560105E-02,  0.136575E-01/

      data ((CN_basic%bf20n2o(mm,m), mm=1,3), m=1,10) / &
     &   0.796928E+00,  0.830259E+00,  0.899043E+00,  &
     &   0.139206E+01,  0.153530E+01,  0.164639E+01,  &
     &   0.114160E+01,  0.155839E+01,  0.167717E+01,  &
     &   0.162487E+01,  0.147819E+01,  0.131212E+01,  &
     &   0.125076E+01,  0.105733E+01,  0.102102E+01, &
     &   0.104909E+01,  0.982661E+00,  0.100841E+01, &
     &   0.902517E+00,  0.956259E+00,  0.105377E+01, &
     &   0.101685E+01,  0.111224E+01,  0.124731E+01, &
     &   0.136088E+01,  0.163802E+01,  0.194435E+01, &
     &   0.997947E+00,  0.112211E+01,  0.128899E+01/

      data ((CN_basic%bf20n2o(mm,m), mm=1,3), m=11,20) /  &
     &   0.107595E+01,  0.119784E+01,  0.133117E+01, &
     &   0.121954E+01,  0.140539E+01,  0.156781E+01,& 
     &   0.157899E+01,  0.182269E+01,  0.199303E+01, & 
     &   0.204989E+01,  0.224315E+01,  0.233227E+01, &
     &   0.195482E+01,  0.193476E+01,  0.185993E+01,  & 
     &   0.319309E+00,  0.275346E+00,  0.242248E+00, &
     &   0.339556E+00,  0.287651E+00,  0.250003E+00, &
     &   0.396327E+00,  0.335936E+00,  0.292710E+00, & 
     &   0.431370E+00,  0.363528E+00,  0.316062E+00, &
     &   0.502689E+00,  0.422020E+00,  0.365905E+00/

!---------------------------------------------------------------------
!   data for ch4 for 10 20 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af10ch4           /    &
     &   0.138007E+02,  0.374756E+02,  0.733424E+02,  &
     &   0.839881E+02,  0.166382E+03,  0.255345E+03, &
     &   0.450102E+03,  0.613544E+03,  0.723358E+03,   &
     &   0.112917E+04,  0.111585E+04,  0.106068E+04,  &
     &   0.129563E+04,  0.124501E+04,  0.123261E+04, &
     &   0.321771E+04,  0.298417E+04,  0.279049E+04, &
     &   0.206177E+04,  0.169306E+04,  0.141746E+04, &
     &   0.148257E+04,  0.165020E+04,  0.170066E+04, &
     &   0.177552E+03,  0.335540E+03,  0.496811E+03,  &
     &   0.731573E+01,  0.212742E+02,  0.496363E+02/

      data CN_basic%bf10ch4           /   &
     &   0.966097E+00,  0.797634E+00,  0.741348E+00,  &
     &   0.708470E+00,  0.694836E+00,  0.731236E+00,  &
     &   0.538280E+00,  0.534382E+00,  0.566677E+00, &
     &   0.395441E+00,  0.407704E+00,  0.457256E+00, &
     &   0.730302E+00,  0.931831E+00,  0.120039E+01, &
     &   0.792897E+00,  0.809010E+00,  0.840987E+00, &
     &   0.344211E+00,  0.359613E+00,  0.411935E+00, &
     &   0.609607E+00,  0.627816E+00,  0.682159E+00, &
     &   0.689011E+00,  0.652106E+00,  0.635154E+00, &
     &   0.150519E+01,  0.136941E+01,  0.121643E+01/

      data CN_basic%bdl10hcn /   &
     &   0.120000E+04,  0.122000E+04,  0.124000E+04,  0.126000E+04,  &
     &   0.128000E+04,  0.130000E+04,  0.132000E+04,  0.134000E+04, &
     &   0.136000E+04,  0.138000E+04                              /

      data CN_basic%bdh10hcn /   &
     &   0.122000E+04,  0.124000E+04,  0.126000E+04,  0.128000E+04, &
     &   0.130000E+04,  0.132000E+04,  0.134000E+04,  0.136000E+04,&
     &   0.138000E+04,  0.140000E+04                              /

!---------------------------------------------------------------------
!   data for n2o for 10 20 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af10n2o           /  &
     &   0.282383E+01,  0.588323E+01,  0.961453E+01,  &
     &   0.711111E+01,  0.141981E+02,  0.281370E+02, &
     &   0.251646E+03,  0.394049E+03,  0.523109E+03,& 
     &   0.249177E+04,  0.237670E+04,  0.224635E+04, &
     &   0.241029E+04,  0.207176E+04,  0.181258E+04, &
     &   0.126034E+04,  0.154361E+04,  0.175301E+04, &
     &   0.729117E+01,  0.285944E+02,  0.714527E+02,  &
     &   0.298941E-03,  0.876237E-02,  0.867950E-01,  &
     &   0.130723E-02,  0.771774E-02,  0.240104E-01, &
     &   0.206675E-02,  0.913778E-02,  0.231763E-01/

      data CN_basic%bf10n2o           /   &
     &   0.833536E+00,  0.925586E+00,  0.104910E+01, &
     &   0.132457E+01,  0.131982E+01,  0.122972E+01, &
     &   0.920526E+00,  0.887745E+00,  0.926776E+00, &
     &   0.949077E+00,  0.103191E+01,  0.115041E+01, &
     &   0.107600E+01,  0.124106E+01,  0.145195E+01, &
     &   0.924199E+00,  0.112588E+01,  0.131769E+01, &
     &   0.976246E+00,  0.125540E+01,  0.149675E+01, &
     &   0.112776E+01,  0.109740E+01,  0.102453E+01, &
     &   0.346911E+00,  0.302015E+00,  0.266614E+00, &
     &   0.445260E+00,  0.371305E+00,  0.320406E+00/

!---------------------------------------------------------------------
!   data for ch4 for 4 50 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af4ch4            /   &
     &   0.113033E+03,  0.193251E+03,  0.272088E+03,  &
     &   0.107604E+04,  0.107805E+04,  0.106605E+04, &
     &   0.252270E+04,  0.229160E+04,  0.208972E+04, &
     &   0.256070E+03,  0.382097E+03,  0.492307E+03/ 

      data CN_basic%bf4ch4            /  &
     &   0.500647E+00,  0.527558E+00,  0.578560E+00, &
     &   0.535571E+00,  0.616947E+00,  0.743988E+00,&
     &   0.566775E+00,  0.584353E+00,  0.630193E+00,  &
     &   0.457544E+00,  0.504264E+00,  0.559155E+00/

      data CN_basic%bdl4hcn /   &
     &   0.120000E+04,  0.125000E+04,  0.130000E+04,  0.135000E+04/

      data CN_basic%bdh4hcn /  &
     &   0.125000E+04,  0.130000E+04,  0.135000E+04,  0.140000E+04/

!---------------------------------------------------------------------
!   data for n2o for 4 50 cm-1 wide bands in 1200-1400 cm-1 range
!---------------------------------------------------------------------
      data CN_basic%af4n2o            /  &
     &   0.168857E+02,  0.360657E+02,  0.613920E+02, &
     &   0.204857E+04,  0.190897E+04,  0.178652E+04, &
     &   0.507052E+03,  0.628883E+03,  0.729817E+03, &
     &   0.137457E-02,  0.700515E-02,  0.200711E-01/

      data CN_basic%bf4n2o            /   &
     &   0.784018E+00,  0.721104E+00,  0.730728E+00,  &
     &   0.949920E+00,  0.106732E+01,  0.121485E+01,  &
     &   0.427617E+00,  0.580534E+00,  0.754951E+00,  &
     &   0.349404E+00,  0.307557E+00,  0.273469E+00/


!---------------------------------------------------------------------
!------- private data ------

real       ::  rch4air, rn2oair



!---------------------------------------------------------------------
!---------------------------------------------------------------------




                         contains


subroutine ch4_n2o_init 


!---------------------------------------------------------------------
      integer    :: unit, ierr, io

!---------------------------------------------------------------------
!   the values of the molecular weights of ch4 and n2o are derived
!   from elemental atomic weights adopted by the International Union of
!   Pure and Applied Chemistry in 1961, and also used in the US Standard
!   Atmosphere, 1976.
!---------------------------------------------------------------------
      real       ::  wtmch4  = 16.04303
      real       ::  wtmn2o  = 44.01280

!---------------------------------------------------------------------
!-----  read namelist  ------

     if (file_exist('input.nml')) then
       unit =  open_file ('input.nml', action='read')
       ierr=1; do while (ierr /= 0)
       read (unit, nml=ch4_n2o_nml, iostat=io, end=10)
       ierr = check_nml_error (io, 'ch4_n2o_nml')
       enddo
10     call close_file (unit)
     endif

     unit = open_file('logfile.out', action='append')
     if (get_my_pe() == 0) then
       write (unit,'(/,80("="),/(a))') trim(version), trim(tag)
       write (unit,nml=ch4_n2o_nml)
     endif
     call close_file (unit)

!--------------------------------------------------------------------
!  define ch4, n2o mixing ratio conversion factors.
!--------------------------------------------------------------------
!     rch4air = wtmch4/wtmair
!     rn2oair = wtmn2o/wtmair

end subroutine ch4_n2o_init




!####################################################################

subroutine ch4_n2o_time_vary (rrvch4, rrvn2o)

!---------------------------------------------------------------------
real, intent(in) :: rrvch4, rrvn2o               

!---------------------------------------------------------------------
     real             ::  ch4_vmr, n2o_vmr

!---------------------------------------------------------------------
!  the ch4 volume mixing ratio is set to the initial value (rch4) and 
!  the mass mixing ratio is defined on the first access of this routine.
!  then the lbl transmission function is calculated. after first access,
!  this routine does nothing. 
!--------------------------------------------------------------------
         ch4_vmr = rrvch4*1.0E+09
         call Ch4_lblinterp  (ch4_vmr)

!---------------------------------------------------------------------
!  the n2o volume mixing ratio is set to initial value (rn2o) and the 
!  mass mixing ratio is defined on the first access of this routine. 
!  routines are called to calculate the lbl transmission functions for 
!  n2o. after first access, this routine does nothing. 
!--------------------------------------------------------------------
         n2o_vmr = rrvn2o*1.0E+09
         call N2o_lblinterp (n2o_vmr)


end subroutine ch4_n2o_time_vary



!####################################################################



		  end module ch4_n2o_mod
