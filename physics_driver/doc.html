<HTML><TITLE>Physics_Driver Documentation</TITLE>
<BODY BGCOLOR="#DDEEFF" TEXT="#000000">
<!-- BASEFONT SIZE=3>

<H2>physics_driver/v1.0</H2>

<P>Provides a high level interface that can perform all physical
   parameterizations.
<P>

<HR SIZE=5>

<H4>New in this version</H4>
<UL>
 <LI> added time manager module

    <UL>
     <LI> argument changes to physics_driver include:
          <BR>timesince (integer) changed to time (time_type)
          <BR>timesince_rad removed (replaced by a namelist value in
                                     radiation_driver)

     <LI> argument changes in physics_driver_init include (also see below):
          <BR>timesince (integer) changed to time      (time_type)
          <BR>date(4) (integer)   changed to time_init (time_type)
              (the call to physics_diag_init also reflects this change)

     <LI> date module initialization no longer done in physics_driver_init
       this must be done through the time manager module by the user

     <LI> argument to physics_driver_end has changed
         timesince (integer) changed to time (time_type)
     </UL>

 <LI> cleaned up check_dim subroutine (internal routine for checking argument dimensions)

 <LI> physics_driver_init interface now passes the grid box edges,
      calls to surface_model_init and radiation_driver_init also
      reflect this change

</UL>

<HR SIZE=5>

<H3>PUBLIC VARIABLES</H3>
<I><P>In this section the following nomenclature applies:
<UL><LI>nlon and nlat are the number of longitude and latitude points for the entire grid
    <LI>nlev is the total number of model levels</UL></I>
<DL>
<DT>SoilWet     <DD>soil wetness in Kg/m2 
                <DD>[real, dimension(nlon,nlat)]

<DT>Ts          <DD>"skin" temperature of the surface in deg K
                <DD>[real, dimension(nlon,nlat)]

<DT>ZoRL        <DD>surface roughness length in meters
                <DD>[real, dimension(nlon,nlat)]

<DT>TKE         <DD>turbulent kinetic energy (actually double) in m2/s2
                    at half model levels
                <DD>[real, dimension(nlon,nlat,nlev+1)]

<DT>Radflux     <DD>radiative surface flux, net SW + downward LW (i.e., for surface heat balance),
                    in watts/m2
                <DD>[real, dimension(nlon,nlat)]

<DT>Albedo      <DD>surface albedo  <DD>[real, dimension(nlon,nlat)]

<DT>AcPrec      <DD>total precipitation in Kg/m2 (accumulated from the
                    start of the current execution)
                <DD>[real, dimension(nlon,nlat)]

<DT>CuPrec      <DD>convective precipitation in Kg/m2 (accumulated, see AcPrec)
                <DD>[real, dimension(nlon,nlat)]

<DT>AcEvap      <DD>total evaporation in Kg/m2 (accumulated, see AcPrec)
                <DD>[real, dimension(nlon,nlat)]

<DT>Snow        <DD>snow cover as a water equivalent in Kg/m2
                <DD>[real, dimension(nlon,nlat)]

<DT>Land        <DD>land mask (true for land points)
                <DD>[logical, dimension(nlon,nlat)]

<DT>Ice         <DD>ice mask (true for ice points, otherwise false)
                <DD>[logical, dimension(nlon,nlat)]

<DT>Sea         <DD>sea mask (opposite of land mask, true for sea points)
                <DD>[logical, dimension(nlon,nlat)]

</DL>

<HR SIZE=5>

<H3>SUMMARY OF PUBLIC INTERFACE CALLS</H3>
<DL>
<DT>Physics_Driver_Init  <DD>Initializes the physics driver and calls
                             initialization routines for all modules that it
                             uses.

<DT>Physics_Driver       <DD>The main call, it updates the tendencies of
                             zonal and meridional wind, temperature,
                             specific humidity, and tracers.
                             Also, many fields internal to the physics driver
                             are updated, see the public variables sub-section 
                             above.

<DT>Physics_Driver_End   <DD>The termination call; writes data required for
                             proper restarting.  Calls termination routines
                             for all modules that it uses.
</DL>

<HR SIZE=5>

<H3>DETAILS OF PUBLIC INTERFACE CALLS</H3>

<TABLE><TR VALIGN="TOP">
<TH>Call Physics_Driver_Init
<TD> ( Lon, Lat, Sfull, Shalf, Time, Time_init, Lonb, Latb,
       Pref, Phalf, Pfull, T, Q, R [,Mask, Kbot] )
</TABLE>


<H4>INPUT</H4>
<DL>
<DT>Lon         <DD>all longitudes for the FULL grid in radians
                <DD>[real, dimension(nlon)]

<DT>Lat         <DD>all latitudes for the FULL grid in radians
                <DD>[real, dimension(nlat)]

<DT>Sfull       <DD>vertical coordinate values at full levels, only used
                    to label the vertical axis on diagnostic (NetCDF) output files
                <DD>[real, dimension(nlev)]

<DT>Shalf       <DD>vertical coordinate values at half levels, only used
                    to label the vertical axis on diagnostic (NetCDF) output files
                <DD>[real, dimension(nlev+1)]

<DT>Time        <DD>the current model time 
                <DD>[time_type]

<DT>Time_init   <DD>the initial model time (for netcdf time axis info)
                <DD>[time_type]

<DT>Lonb        <DD>longitude in radians for all grid box boundaries
                <DD>[real, dimension(nlon+1)]

<DT>Latb        <DD>latitude in radians for all grid box boundaries
                <DD>[real, dimension(nlat+1)]

<DT>Pref        <DD>two reference pressure profiles in Pascals at full levels,
                    except at nlev+1 where, Pref(nlev+1,1) = 101325. and
                    Pref(nlev+1,2) = 81060.
                <DD>used to initialize co2 transmission functions for radiation
                <DD>[real, dimension(nlev+1,2)]

<DT>Phalf       <DD>pressure in Pascals for the FULL grid at half levels (offset
                    from T,Q, and R)
                <DD>[real, dimension(nlon,nlat,nlev+1)]

<DT>Pfull       <DD>pressure in Pascals for the FULL grid at full levels
                    (located with T,Q, and R)
                <DD>[real, dimension(nlon,nlat,nlev)]

<DT>T, Q        <DD>temperature and specific humidity for the FULL grid
                <DD>[real, dimension(nlon,nlat,nlev)]
</DL>

<H4>INPUT/OUTPUT</H4>
<DL>
<DT>R           <DD>multiple 3d tracer fields for the FULL grid
                <DD>[real, dimension(nlon,nlat,nlev,ntrace)]
</DL>

<H4>INPUT (OPTIONAL)</H4>
<DL>
<DT>Mask  <DD>Mask for the FULL grid that designates which levels do not have data
              present (i.e., below ground)
          <UL><LI>if Mask=0. then no data (below ground)
              <LI>if Mask=1. then data (over ground)</UL>
          <DD>[real, dimension(nlon,nlat,nlev)]

<DT>Kbot  <DD>lowest level with data (for step mountain coord.)
              for the FULL grid
          <DD>[integer, dimension(nlon,nlat)]
</DL>

<H4>NOTES:</H4>
<UL><LI>In the call to <B>Physics_Driver_Init</B>, nlev, nlat, and nlev
        refer to dimensions of the entire (global) grid.
</UL>

<HR SIZE=1>

<TABLE><TR VALIGN="TOP">
<TH>Call Physics_Driver
<TD>                    ( istart, DT, Time, Lat, Lon, Area,
                          Phalf, Pfull, Zhalf, Zfull,
                          U, V, T, Q, R, UM, VM, TM, QM, RM,
                          Udt, Vdt, Tdt, Qdt, Rdt
                          [, Mask, Kbot] )
</TABLE>

<H4>INPUT</H4>
<DL>
<DT>istart     <DD>starting i,j indices in the current sub-grid window of the full horizontal grid
               <DD>[integer, dimension(2)]

<DT>DT         <DD>time step in seconds
               <DD>[real]

<DT>Time       <DD>the current model time
               <DD>[time_type]

<DT>Lat, Lon   <DD>latitude (Lat) and longitude (Lon) in radians
               <DD>[real, dimension(nlon,nlat)]

<DT>Area       <DD>fractional area of the full grid for each grid box
               <DD>[real, dimension(nlon,nlat)]

<DT>Phalf      <DD>pressure in Pascals at half levels
               <DD>[real, dimension(nlon,nlat,nlev+1)]

<DT>Pfull      <DD>pressure in Pascals at full levels
               <DD>[real, dimension(nlon,nlat,nlev)]

<DT>Zhalf      <DD>height in meters at half levels
               <DD>[real, dimension(nlon,nlat,nlev+1)]

<DT>Zfull      <DD>height in meters at full levels
               <DD>[real, dimension(nlon,nlat,nlev)]

<DT>U,V,T,Q    <DD>zonal wind (m/s), meridional wind (m/s), temperature (deg K),
                   and specific humidity (kg vapor/kg air) at the current time
                   step at full model levels
               <DD>[real, dimension(nlon,nlat,nlev)]

<DT>R          <DD>multiple 3d tracer fields at current time step at full model levels
               <DD>[real, dimension(nlon,nlat,nlev,ntrace)]

<DT>UM,VM,TM,QM  <DD>zonal wind, meridional wind, temperature, and specific
                     humidity at previous time step at full model levels
                 <DD>[real, dimension(nlon,nlat,nlev)]

<DT>RM         <DD>multiple (ntrace) 3d tracer fields at previous time step at full model levels
               <DD>[real, dimension(nlon,nlat,nlev,ntrace)]
</DL>
 
<H4>INPUT/OUTPUT</H4>
<DL>
<DT>Udt,Vdt,Tdt,Qdt  <DD>zonal (Udt) and meridional wind tendency (Vdt) in m/s2,
                         and temperature tendency (Tdt) in deg K/sec, and
                         specific humidity tendency in Kg vapor/Kg air/sec
                     <DD>[real, dimension(nlon,nlat,nlev)]

<DT>Rdt        <DD>multiple tracer tendencies (in unit/unit/sec ???)
               <DD>[real, dimension(nlon,nlat,nlev,ntrace)]
</DL>
 
<H4>INPUT (OPTIONAL)</H4>
<DL>
<DT>Mask      <DD>Mask that designates which levels do not have data
                  present (i.e., below ground)
              <UL><LI>if Mask=0. then no data (below ground)
                  <LI>if Mask=1. then data (over ground)</UL>
              <DD>[real, dimension(nlon,nlat,nlev)]

<DT>Kbot      <DD>Lowest level which has data
              <DD>NOTE:  Both Mask and Kbot must be present together.
              <DD>[integer, dimension(nlon,nlat)]
</DL>

<H4>NOTES:</H4>
<UL><LI>In the call to <B>Physics_Driver</B>, nlev and nlat refer to the size
        of the sub-grid window (see istart), nlev refers to <b>all</b> vertical
        model levels, and ntrace is the number of tracers.
    <LI>On the first call to <B>Physics_Driver</B> the size of all calling
        arguments is checked for consistency.
</UL>
 
<HR SIZE=1>

<TABLE><TR VALIGN="TOP">
<TH>Call Physics_Driver_End
<TD>(Time)
</TABLE>


<H4>INPUT</H4>
<DL>
<DT>Time   <DD>time in seconds since the start of current run
           <DD>[integer]
</DL>

<HR SIZE=5>

<H3>RESTART DATA</H3>

<P>
      The following restart data set is read and written
      by the physics_driver.

<DL>
  <DT>sea_mask.res   <DD>contains two records
                     <OL><LI> land/sea mask (land=0.0; sea=1.0, ice=0.0)
                         <LI> sea/ice mask  (land=0.0, sea=0.0, ice=1.0)</OL>
                     <DD>notes:
                     <UL><LI>each record contains the full global field
                         <LI>record one is mandatory
                         <LI>record two is optional</UL>
</DL>
                            
<HR SIZE=5>

</BODY></HTML>
