
VERSIONS
--------

PUBLIC VARIABLES
----------------

SoilWet      soil wetness in Kg/m2  [real, dimension(nlon,nlat)]

Ts           "skin" temperature of the surface in deg K
                 [real, dimension(nlon,nlat)]

ZoRL         surface roughness length in meters
                 [real, dimension(nlon,nlat)]

TKE          turbulent kinetic energy (actually double) in m2/s2
             at half model levels  [real, dimension(nlon,nlat,nlev+1)]

Radflux      radiative surface flux (for surface heat balance)
             in watts/m2  [real, dimension(nlon,nlat)]

Albedo       surface albedo  [real, dimension(nlon,nlat)]

AcPrec       total precipitation in Kg/m2 (accumulated from the
             start of the current run)  [real, dimension(nlon,nlat)]

CuPrec       convective precipitation in Kg/m2 (accumulated)
                [real, dimension(nlon,nlat)]

AcEvap       total evaporation in Kg/m2 (accumulated)
                [real, dimension(nlon,nlat)]

Snow         snow cover as a water equivalent in Kg/m2
                [real, dimension(nlon,nlat)]

Land         land mask (true for land points)
                [logical, dimension(nlon,nlat)]

Ice          ice mask (true for ice points, otherwise false)
                [logical, dimension(nlon,nlat)]

Sea          sea mask (opposite of land mask, true for sea points)
                [logical, dimension(nlon,nlat)]

************************************************************************

INTERFACE SUMMARY
-----------------

   Physics_Driver_Init - initializes the physics driver

   Physics_Driver      - main call, computes updates tendencies of
                         zonal and meridional wind, temperature,
                         specific humidity, and tracers.  Also, many
                         fields internal to the physics driver are updated.

   Physics_Driver_End  - terminates data sets associated with 
                         the physics driver


========================================================================
---------------------------    USAGE    --------------------------------
========================================================================

Call Physics_Driver_Init ( Lon, Lat, Sfull, Shalf, TimeSince,
                           Date, Pref, Phalf, Pfull, T, Q, R, Kbot )


   INPUT
   -----

   Lon         all longitudes for the FULL grid in radians
                 [real, dimension(nlon)]

   Lat         all latitudes for the FULL grid in radians
                 [real, dimension(nlat)]

   Sfull       vertical coordinate values at full levels
                 [real, dimension(nlev)]

   Shalf       vertical coordinate values at half levels
                 [real, dimension(nlev+1)]

   TimeSince   time since the start of current run in seconds
                 [integer]

   Date        date (i.e., year,month,day,hour) at TimeSince = 0
                 [integer, dimension(2)]

   Pref        two reference pressure profiles in Pascals at full levels,
               except at nlev+1 where, Pref(nlev+1,1) = 101325. and
               Pref(nlev+1,2) = 81060.
                 [real, dimension(nlev+1,2)]

   Phalf       pressure in Pascals for the FULL grid at half levels (offset
               from T,Q, and R)
                 [real, dimension(nlon,nlat,nlev+1)]

   Pfull       pressure in Pascals for the FULL grid at full levels (located
               with T,Q, and R)
                 [real, dimension(nlon,nlat,nlev)]

   T, Q        temperature and specific humidity for the FULL grid
                 [real, dimension(nlon,nlat,nlev)]

   INPUT/OUTPUT
   ------------

   R           multiple 3d tracer fields for the FULL grid
                 [real, dimension(nlon,nlat,nlev,ntrace)]

   INPUT (OPTIONAL)
   ----------------

   Kbot       lowest level with data (for step mountain coord.)
              for the FULL grid
                [integer, dimension(nlon,nlat)]

========================================================================

Call Physics_Driver ( istart, DT, TimeSince, TimeSince_rad, Lat, Lon, Area,
                      Phalf, Pfull, Zhalf, Zfull,
                      U, V, T, Q, R, UM, VM, TM, QM, RM,
                      Udt, Vdt, Tdt, Qdt, Rdt,
                      Mask, Kbot )


   INPUT
   -----

   istart      starting i,j indices in the full horizontal grid
                 [integer, dimension(2)]

   DT          time step in seconds
                 [real]

   TimeSince   time since the start of current run in seconds,
               only used to determine when radiation should be
               calculated and when diagnostics should be output.
                 [integer]

   TimeSince_rad  same as TimeSince except only used for radiative
                  purposes, can be used to fix the time of year
                  (i.e, a pertpetual season run)
                     [integer]

   Lon         longitude in radians
                 [real, dimension(nlon,nlat)]

   Lat         latitude in radians
                 [real, dimension(nlon,nlat)]

   Area        fractional area of the full grid for each grid box
                 [real, dimension(nlon,nlat)]

   Phalf       pressure in Pascals at half levels (offset from T,Q,U,V,R)
                 [real, dimension(nlon,nlat,nlev+1)]

   Pfull       pressure in Pascals at full levels
                 [real, dimension(nlon,nlat,nlev)]

   Zhalf       height in meters at half levels
                 [real, dimension(nlon,nlat,nlev+1)]

   Zfull       height in meters at full levels
                 [real, dimension(nlon,nlat,nlev)]

   U,V,T,Q     zonal wind (m/s), meridional wind (m/s), temperature (deg K),
               and specific humidity (kg vapor/kg air) at the current time step
                 [real, dimension(nlon,nlat,nlev)]

   R           multiple 3d tracer fields at current time step
                 [real, dimension(nlon,nlat,nlev,ntrace)]

   UM,VM       zonal and meridional wind at previous time step
   TM,QM       temperature and specific humidity at previous time step
                 [real, dimension(nlon,nlat,nlev)]

   RM          multiple 3d tracer fields at previous time step
                 [real, dimension(nlon,nlat,nlev,ntrace)]
 
   INPUT/OUTPUT
   ------------

   Udt,Vdt     zonal and meridional wind tendency in m/s2
               meridional wind tendency in m/s2
                 [real, dimension(nlon,nlat,nlev)]

   Tdt,Qdt     temperature tendency in deg K per sec and specific humidity
               tendency in Kg vapor/Kg air/sec
                 [real, dimension(nlon,nlat,nlev)]
 
   Rdt         multiple tracer tendencies (in unit/unit/sec ???)
                 [real, dimension(nlon,nlat,nlev,ntrace)]
 
   OPTIONAL INPUT
   --------------

   Mask        Mask that designates which levels do not have data
               present (i.e., below ground); 0.=no data, 1.=data
                 [real, dimension(nlon,nlat,nlev)]

   Kbot        Lowest level which has data
               NOTE:  Both Mask and Kbot must be present together.
                 [integer, dimension(nlon,nlat)]
 
========================================================================

Call Physics_Driver_End (TimeSince)


   INPUT
   -----

   TimeSince   time since the start of current run in seconds
                 [integer]

========================================================================
========================================================================
                       NAMELIST INPUT
------------------------------------------------------------------------

   namelist /physics_driver_nml/  Auto_Init


   Auto_Init   specifies whether the input snow cover should be automatically
               initialized if the restart data does not exist
                 [logical, default: Auto_Init=.false.]

========================================================================
                       REQUIRED DATA SETS
------------------------------------------------------------------------

      sea_mask.res   contains two records
                        1) land/sea mask (land=0.0; sea=1.0, ice=0.0)
                        2) sea/ice mask  (land=0.0, sea=0.0, ice=1.0)
                     notes: each record contains the full global field
                            record one is mandatory
                            record two is optional
                            
    snow_cover.res   contains one record of the global snow cover
                     as a water equivalent in Kg/m2; if this file
                     is not present and you want the field initialized
                     as zero, you must specify the namelist variable
                     Auto_Init = .true.

========================================================================
